function fitVertical(a,b){var c=parseInt(b)||$(a).offset().top;return c+$(a).height()<=getWindowHeight()+getScrollTop()&&c-getScrollTop()>=0}function fitHorizontal(a,b){var c=parseInt(b)||$(a).offset().left;return c+$(a).width()<=getWindowWidth()+getScrollLeft()&&c-getScrollLeft()>=0}function getWindowWidth(){var a=document.documentElement;return self.innerWidth||a&&a.clientWidth||document.body.clientWidth}function getWindowHeight(){var a=document.documentElement;return self.innerHeight||a&&a.clientHeight||document.body.clientHeight}function getScrollLeft(){return self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft}function getScrollTop(){return self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop}function sortBigToSmall(a,b){return b-a}function Menu(a,b){var c=this;var a=$(a);var d=$('<div class="fg-menu-container ui-widget ui-widget-content ui-corner-all">'+b.content+"</div>");this.menuOpen=false;this.menuExists=false;var b=jQuery.extend({content:null,width:180,maxHeight:180,positionOpts:{posX:"left",posY:"bottom",offsetX:0,offsetY:0,directionH:"right",directionV:"down",detectH:true,detectV:true,linkToFront:false},showSpeed:200,callerOnState:"ui-state-active",loadingState:"ui-state-loading",linkHover:"ui-state-hover",linkHoverSecondary:"li-hover",crossSpeed:200,crumbDefaultText:"Choose an option:",backLink:true,backLinkText:"Back",flyOut:false,flyOutOnState:"ui-state-default",nextMenuLink:"ui-icon-triangle-1-e",topLinkText:"All",nextCrumbLink:"ui-icon-carat-1-e"},b);var e=function(){$.each(allUIMenus,function(a){if(allUIMenus[a].menuOpen){allUIMenus[a].kill()}})};this.kill=function(){a.removeClass(b.loadingState).removeClass("fg-menu-open").removeClass(b.callerOnState);d.find("li").removeClass(b.linkHoverSecondary).find("a").removeClass(b.linkHover);if(b.flyOutOnState){d.find("li a").removeClass(b.flyOutOnState)}if(b.callerOnState){a.removeClass(b.callerOnState)}if(d.is(".fg-menu-ipod")){c.resetDrilldownMenu()}if(d.is(".fg-menu-flyout")){c.resetFlyoutMenu()}d.parent().hide();c.menuOpen=false;$(document).unbind("click",e);$(document).unbind("keydown")};this.showLoading=function(){a.addClass(b.loadingState)};this.showMenu=function(){e();if(!c.menuExists){c.create()}a.addClass("fg-menu-open").addClass(b.callerOnState);d.parent().show().click(function(){c.kill();return false});d.hide().slideDown(b.showSpeed).find(".fg-menu:eq(0)");c.menuOpen=true;a.removeClass(b.loadingState);$(document).click(e);$(document).keydown(function(a){var c;if(a.which!=""){c=a.which}else if(a.charCode!=""){c=a.charCode}else if(a.keyCode!=""){c=a.keyCode}var f=$(a.target).parents("div").is(".fg-menu-flyout")?"flyout":"ipod";switch(c){case 37:if(f=="flyout"){$(a.target).trigger("mouseout");if($("."+b.flyOutOnState).size()>0){$("."+b.flyOutOnState).trigger("mouseover")}}if(f=="ipod"){$(a.target).trigger("mouseout");if($(".fg-menu-footer").find("a").size()>0){$(".fg-menu-footer").find("a").trigger("click")}if($(".fg-menu-header").find("a").size()>0){$(".fg-menu-current-crumb").prev().find("a").trigger("click")}if($(".fg-menu-current").prev().is(".fg-menu-indicator")){$(".fg-menu-current").prev().trigger("mouseover")}}return false;break;case 38:if($(a.target).is("."+b.linkHover)){var g=$(a.target).parent().prev().find("a:eq(0)");if(g.size()>0){$(a.target).trigger("mouseout");g.trigger("mouseover")}}else{d.find("a:eq(0)").trigger("mouseover")}return false;break;case 39:if($(a.target).is(".fg-menu-indicator")){if(f=="flyout"){$(a.target).next().find("a:eq(0)").trigger("mouseover")}else if(f=="ipod"){$(a.target).trigger("click");setTimeout(function(){$(a.target).next().find("a:eq(0)").trigger("mouseover")},b.crossSpeed)}}return false;break;case 40:if($(a.target).is("."+b.linkHover)){var h=$(a.target).parent().next().find("a:eq(0)");if(h.size()>0){$(a.target).trigger("mouseout");h.trigger("mouseover")}}else{d.find("a:eq(0)").trigger("mouseover")}return false;break;case 27:e();break;case 13:if($(a.target).is(".fg-menu-indicator")&&f=="ipod"){$(a.target).trigger("click");setTimeout(function(){$(a.target).next().find("a:eq(0)").trigger("mouseover")},b.crossSpeed)}break}})};this.create=function(){d.css({width:b.width}).appendTo("body").find("ul:first").not(".fg-menu-breadcrumb").addClass("fg-menu");d.find("ul, li a").addClass("ui-corner-all");d.find("ul").attr("role","menu").eq(0).attr("aria-activedescendant","active-menuitem").attr("aria-labelledby",a.attr("id"));d.find("li").attr("role","menuitem");d.find("li:has(ul)").attr("aria-haspopup","true").find("ul").attr("aria-expanded","false");d.find("a").attr("tabindex","-1");if(d.find("ul").size()>1){if(b.flyOut){c.flyout(d,b)}else{c.drilldown(d,b)}}else{d.find("a").click(function(){c.chooseItem(this);return false})}if(b.linkHover){var e=d.find(".fg-menu li a");e.hover(function(){var a=$(this);$("."+b.linkHover).removeClass(b.linkHover).blur().parent().removeAttr("id");$(this).addClass(b.linkHover).focus().parent().attr("id","active-menuitem")},function(){$(this).removeClass(b.linkHover).blur().parent().removeAttr("id")})}if(b.linkHoverSecondary){d.find(".fg-menu li").hover(function(){$(this).siblings("li").removeClass(b.linkHoverSecondary);if(b.flyOutOnState){$(this).siblings("li").find("a").removeClass(b.flyOutOnState)}$(this).addClass(b.linkHoverSecondary)},function(){$(this).removeClass(b.linkHoverSecondary)})}c.setPosition(d,a,b);c.menuExists=true};this.chooseItem=function(a){c.kill();$("#menuSelection").text($(a).text());location.href=$(a).attr("href")}}var allUIMenus=[];$.fn.fgmenu=function(a){var b=this;var a=a;var c=new Menu(b,a);allUIMenus.push(c);$(this).mousedown(function(){if(!c.menuOpen){c.showLoading()}}).click(function(){if(c.menuOpen==false){c.showMenu()}else{c.kill()}return false})};Menu.prototype.flyout=function(a,b){var c=this;this.resetFlyoutMenu=function(){var b=a.find("ul ul");b.removeClass("ui-widget-content").hide()};a.addClass("fg-menu-flyout").find("li:has(ul)").each(function(){var c=a.width();var d,e;var f=$(this).find("ul");f.css({left:c,width:c}).hide();$(this).find("a:eq(0)").addClass("fg-menu-indicator").html("<span>"+$(this).find("a:eq(0)").text()+'</span><span class="ui-icon '+b.nextMenuLink+'"></span>').hover(function(){clearTimeout(e);var a=$(this).next();if(!fitVertical(a,$(this).offset().top)){a.css({top:"auto",bottom:0})}if(!fitHorizontal(a,$(this).offset().left+100)){a.css({left:"auto",right:c,"z-index":999})}d=setTimeout(function(){a.addClass("ui-widget-content").show(b.showSpeed).attr("aria-expanded","true")},300)},function(){clearTimeout(d);var a=$(this).next();e=setTimeout(function(){a.removeClass("ui-widget-content").hide(b.showSpeed).attr("aria-expanded","false")},400)});$(this).find("ul a").hover(function(){clearTimeout(e);if($(this).parents("ul").prev().is("a.fg-menu-indicator")){$(this).parents("ul").prev().addClass(b.flyOutOnState)}},function(){e=setTimeout(function(){f.hide(b.showSpeed);a.find(b.flyOutOnState).removeClass(b.flyOutOnState)},500)})});a.find("a").click(function(){c.chooseItem(this);return false})};Menu.prototype.drilldown=function(a,b){var c=this;var d=a.find(".fg-menu");var e=$('<ul class="fg-menu-breadcrumb ui-widget-header ui-corner-all ui-helper-clearfix"></ul>');var f=$('<li class="fg-menu-breadcrumb-text">'+b.crumbDefaultText+"</li>");var g=b.backLink?b.backLinkText:b.topLinkText;var h=b.backLink?"fg-menu-prev-list":"fg-menu-all-lists";var i=b.backLink?"ui-state-default ui-corner-all":"";var j=b.backLink?'<span class="ui-icon ui-icon-triangle-1-w"></span>':"";var k=$('<li class="'+h+'"><a href="#" class="'+i+'">'+j+g+"</a></li>");a.addClass("fg-menu-ipod");if(b.backLink){e.addClass("fg-menu-footer").appendTo(a).hide()}else{e.addClass("fg-menu-header").prependTo(a)}e.append(f);var l=function(a){if(a.height()>b.maxHeight){a.addClass("fg-menu-scroll")}a.css({height:b.maxHeight})};var m=function(a){a.removeClass("fg-menu-scroll").removeClass("fg-menu-current").height("auto")};this.resetDrilldownMenu=function(){$(".fg-menu-current").removeClass("fg-menu-current");d.animate({left:0},b.crossSpeed,function(){$(this).find("ul").each(function(){$(this).hide();m($(this))});d.addClass("fg-menu-current")});$(".fg-menu-all-lists").find("span").remove();e.empty().append(f);$(".fg-menu-footer").empty().hide();l(d)};d.addClass("fg-menu-content fg-menu-current ui-widget-content ui-helper-clearfix").css({width:a.width()}).find("ul").css({width:a.width(),left:a.width()}).addClass("ui-widget-content").hide();l(d);d.find("a").each(function(){if($(this).next().is("ul")){$(this).addClass("fg-menu-indicator").each(function(){$(this).html("<span>"+$(this).text()+'</span><span class="ui-icon '+b.nextMenuLink+'"></span>')}).click(function(){var f=$(this).next();var g=$(this).parents("ul:eq(0)");var h=g.is(".fg-menu-content")?0:parseFloat(d.css("left"));var i=Math.round(h-parseFloat(a.width()));var j=$(".fg-menu-footer");m(g);l(f);d.animate({left:i},b.crossSpeed);f.show().addClass("fg-menu-current").attr("aria-expanded","true");var n=function(a){var b=a;var c=$(".fg-menu-current");var d=c.parents("ul:eq(0)");c.hide().attr("aria-expanded","false");m(c);l(d);d.addClass("fg-menu-current").attr("aria-expanded","true");if(d.hasClass("fg-menu-content")){b.remove();j.hide()}};if(b.backLink){if(j.find("a").size()==0){j.show();$('<a href="#"><span class="ui-icon ui-icon-triangle-1-w"></span> <span>Back</span></a>').appendTo(j).click(function(){var c=$(this);var e=parseFloat(d.css("left"))+a.width();d.animate({left:e},b.crossSpeed,function(){n(c)});return false})}}else{if(e.find("li").size()==1){e.empty().append(k);k.find("a").click(function(){c.resetDrilldownMenu();return false})}$(".fg-menu-current-crumb").removeClass("fg-menu-current-crumb");var o=$(this).find("span:eq(0)").text();var p=$('<li class="fg-menu-current-crumb"><a href="javascript://" class="fg-menu-crumb">'+o+"</a></li>");p.appendTo(e).find("a").click(function(){if($(this).parent().is(".fg-menu-current-crumb")){c.chooseItem(this)}else{var a=-($(".fg-menu-current").parents("ul").size()-1)*244;d.animate({left:a},b.crossSpeed,function(){n()});$(this).parent().addClass("fg-menu-current-crumb").find("span").remove();$(this).parent().nextAll().remove()}return false});p.prev().append(' <span class="ui-icon '+b.nextCrumbLink+'"></span>')}return false})}else{$(this).click(function(){c.chooseItem(this);return false})}})};Menu.prototype.setPosition=function(a,b,c){var d=a;var e=b;var f={refX:e.offset().left,refY:e.offset().top,refW:e.getTotalWidth(),refH:e.getTotalHeight()};var c=c;var g,h;var i=$('<div class="positionHelper"></div>');i.css({position:"absolute",left:f.refX,top:f.refY,width:f.refW,height:f.refH});d.wrap(i);switch(c.positionOpts.posX){case"left":g=0;break;case"center":g=f.refW/2;break;case"right":g=f.refW;break}switch(c.positionOpts.posY){case"top":h=0;break;case"center":h=f.refH/2;break;case"bottom":h=f.refH;break}g+=c.positionOpts.offsetX;h+=c.positionOpts.offsetY;if(c.positionOpts.directionV=="up"){d.css({top:"auto",bottom:h});if(c.positionOpts.detectV&&!fitVertical(d)){d.css({bottom:"auto",top:h})}}else{d.css({bottom:"auto",top:h});if(c.positionOpts.detectV&&!fitVertical(d)){d.css({top:"auto",bottom:h})}}if(c.positionOpts.directionH=="left"){d.css({left:"auto",right:g});if(c.positionOpts.detectH&&!fitHorizontal(d)){d.css({right:"auto",left:g})}}else{d.css({right:"auto",left:g});if(c.positionOpts.detectH&&!fitHorizontal(d)){d.css({left:"auto",right:g})}}if(c.positionOpts.linkToFront){e.clone().addClass("linkClone").css({position:"absolute",top:0,right:"auto",bottom:"auto",left:0,width:e.width(),height:e.height()}).insertAfter(d)}};jQuery.fn.getTotalWidth=function(){return $(this).width()+parseInt($(this).css("paddingRight"))+parseInt($(this).css("paddingLeft"))+parseInt($(this).css("borderRightWidth"))+parseInt($(this).css("borderLeftWidth"))};jQuery.fn.getTotalHeight=function(){return $(this).height()+parseInt($(this).css("paddingTop"))+parseInt($(this).css("paddingBottom"))+parseInt($(this).css("borderTopWidth"))+parseInt($(this).css("borderBottomWidth"))};Number.prototype.pxToEm=String.prototype.pxToEm=function(a){a=jQuery.extend({scope:"body",reverse:false},a);var b=this==""?0:parseFloat(this);var c;var d=function(){var a=document.documentElement;return self.innerWidth||a&&a.clientWidth||document.body.clientWidth};if(a.scope=="body"&&$.browser.msie&&(parseFloat($("body").css("font-size"))/d()).toFixed(1)>0){var e=function(){return(parseFloat($("body").css("font-size"))/d()).toFixed(3)*16};c=e()}else{c=parseFloat(jQuery(a.scope).css("font-size"))}var f=a.reverse==true?(b*c).toFixed(2)+"px":(b/c).toFixed(2)+"em";return f}